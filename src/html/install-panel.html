<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-item/all-imports.html">
<link rel="import" href="../../bower_components/paper-styles/demo-pages.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../../bower_components/paper-progress/paper-progress.html">

<link rel="import" href="colors.html">

<dom-module id="install-panel">
	<style >

		:host {
			background-color: white;
    		padding: 24px;
    		margin: 0 24px 24px 24px;
    		display: inline-block;
   			@apply(--shadow-elevation-2dp);
		}
		hr {
			border: 0;
			height: 1px;
			background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,0.75), rgba(0,0,0,0));
			margin-bottom: 50px;
		}
		h2 {
			margin-bottom: 5px;
			margin-top: 0px;
		}
		:host > div {
			@apply(--layout-vertical);
			align-items: center;
		}
		paper-item {
			width: 90%;
		}
		paper-item span {
			margin: 0 auto;
			overflow: hidden;
			text-overflow: ellipsis;
			word-wrap: normal;
			text-align: left;
		}
		
		iron-icon.hidden {
			opacity: 0 !important;
		}
		paper-item iron-icon {
			margin-top: 5px;
			--iron-icon-height: 30px;
			--iron-icon-width: 30px;
			transition: opacity .5s;
			opacity: 1;
		}
		paper-fab {
			--paper-fab-background: var(--bt-light-orange);
			margin-top: 30px;
			opacity: 1;
			transition: opacity 0.5s;
		}
		paper-fab.hidden {
			opacity: 0 !important;
			pointer-events: none !important;
		}

        paper-progress {
             --paper-progress-active-color: var(--bt-light-orange);
             width: 90%;
             margin: 0 auto;
        }

	</style>
	<template>
			<h2>Install</h2><hr/>
        	<div class="list short">
        		<paper-item>
        			<span>{{statusText}}</span>
        		</paper-item>
                <paper-item>
                    <paper-progress disabled="[[progressDisabled]]" indeterminate="[[indeterminate]]" value="[[progressValue]]"></paper-progress>
                </paper-item>
        	</div>
        	<div class="list short horizontal"><paper-fab icon="icons:file-upload" disabled="[[flashInProgress]]" id="uploadBtn" on-click="_uploadClick" elevation="5"></paper-fab>
	</template>
</dom-module>

<script>
Polymer({
	is: 'install-panel',
	properties: {
        flashInProgress: Boolean,
        statusText: String,
        indeterminate: Boolean,
        progressValue: Number,
        progressDisabled: Boolean
	},
	_uploadClick: function() {
		//Fire beginUpload event
		this.fire("beginFirmwareUpload", null, {bubbles: true, cancelable: false, node: this});
		//Set the flash as in progress
        this.flashInProgress = true;
        this.prgressDisabled = false;
	},
	ready: function() {
        this.flashInProgress = false;
        this.statusText = "Ready";
        this.indeterminate = true;
        this.progressDisabled = true;
        this.progressValue = 0;
	},
    resetProgress: function() {
        this.flashInProgress = false;
        this.indeterminate = true;
        this.progressDisabled = true;
        this.progressValue = 0;
    },
	_updateButton: function() {
		if (this.flashInProgress) {
			this.$.uploadBtn.classList.add('hidden');
		}
		else {
			this.$.uploadBtn.classList.remove('hidden');
		}
	}
});
</script>